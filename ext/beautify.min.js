function js_beautify(d,B){var c,E,r,U,n,y,C,v,e,ag;var H,ab,g,p,x,af;var S,Z,G;var W,ak,k;var aj="";B=B?B:{};var T;if(B.space_after_anon_function!==undefined&&B.jslint_happy===undefined){B.jslint_happy=B.space_after_anon_function;
}if(B.braces_on_own_line!==undefined){T=B.braces_on_own_line?"expand":"collapse";}T=B.brace_style?B.brace_style:(T?T:"collapse");var L=B.indent_size?B.indent_size:4;var j=B.indent_char?B.indent_char:" ";
var Y=typeof B.preserve_newlines==="undefined"?true:B.preserve_newlines;var z=typeof B.max_preserve_newlines==="undefined"?false:B.max_preserve_newlines;var u=B.jslint_happy==="undefined"?false:B.jslint_happy;
var m=typeof B.keep_array_indentation==="undefined"?false:B.keep_array_indentation;var I=typeof B.space_before_conditional==="undefined"?true:B.space_before_conditional;var l=typeof B.indent_case==="undefined"?false:B.indent_case;
var ac=typeof B.unescape_strings==="undefined"?false:B.unescape_strings;ak=false;var w=d.length;function s(i){i=typeof i==="undefined"?false:i;while(E.length&&(E[E.length-1]===" "||E[E.length-1]===ag||E[E.length-1]===aj||(i&&(E[E.length-1]==="\n"||E[E.length-1]==="\r")))){E.pop();
}}function a(i){return i.replace(/^\s\s*|\s\s*$/,"");}function ae(al){al=al.replace(/\x0d/g,"");var t=[],i=al.indexOf("\n");while(i!=-1){t.push(al.substring(0,i));al=al.substring(i+1);i=al.indexOf("\n");
}if(al.length){t.push(al);}return t;}function h(){var i=m;m=false;D();m=i;}function D(al){v.eat_next_space=false;if(m&&P(v.mode)){return;}al=typeof al==="undefined"?true:al;v.if_line=false;s();if(!E.length){return;
}if(E[E.length-1]!=="\n"||!al){ak=true;E.push("\n");}if(aj){E.push(aj);}for(var t=0;t<v.indentation_level;t+=1){E.push(ag);}if(v.var_line&&v.var_line_reindented){E.push(ag);}if(v.case_body){E.push(ag);
}}function A(){if(U==="TK_COMMENT"){return D();}if(v.eat_next_space){v.eat_next_space=false;return;}var i=" ";if(E.length){i=E[E.length-1];}if(i!==" "&&i!=="\n"&&i!==ag){E.push(" ");}}function K(){ak=false;
v.eat_next_space=false;E.push(r);}function q(){v.indentation_level+=1;}function R(){if(E.length&&E[E.length-1]===ag){E.pop();}}function o(i){if(v){e.push(v);}v={previous_mode:v?v.mode:"BLOCK",mode:i,var_line:false,var_line_tainted:false,var_line_reindented:false,in_html_comment:false,if_line:false,in_case_statement:false,in_case:false,case_body:false,eat_next_space:false,indentation_baseline:-1,indentation_level:(v?v.indentation_level+(v.case_body?1:0)+((v.var_line&&v.var_line_reindented)?1:0):0),ternary_depth:0};
}function P(i){return i==="[EXPRESSION]"||i==="[INDENTED-EXPRESSION]";}function F(i){return M(i,["[EXPRESSION]","(EXPRESSION)","(FOR-EXPRESSION)","(COND-EXPRESSION)"]);}function f(){G=v.mode==="DO_BLOCK";
if(e.length>0){var i=v.mode;v=e.pop();v.previous_mode=i;}}function ai(al,an){for(var am=0;am<al.length;am++){var t=a(al[am]);if(t.charAt(0)!==an){return false;}}return true;}function O(i){return M(i,["case","return","do","if","throw","else"]);
}function M(am,t){for(var al=0;al<t.length;al+=1){if(t[al]===am){return true;}}return false;}function V(t){var i=p;var al=c.charAt(i);while(M(al,H)&&al!=t){i++;if(i>=w){return 0;}al=c.charAt(i);}return al;
}function aa(){k=0;if(p>=w){return["","TK_EOF"];}W=false;var aw=c.charAt(p);p+=1;var ay=m&&P(v.mode);if(ay){var ap=0;while(M(aw,H)){if(aw==="\n"){s();E.push("\n");ak=true;ap=0;}else{if(aw==="\t"){ap+=4;
}else{if(aw==="\r"){}else{ap+=1;}}}if(p>=w){return["","TK_EOF"];}aw=c.charAt(p);p+=1;}if(v.indentation_baseline===-1){v.indentation_baseline=ap;}if(ak){var ar;for(ar=0;ar<v.indentation_level+1;ar+=1){E.push(ag);
}if(v.indentation_baseline!==-1){for(ar=0;ar<ap-v.indentation_baseline;ar++){E.push(" ");}}}}else{while(M(aw,H)){if(aw==="\n"){k+=((z)?(k<=z)?1:0:1);}if(p>=w){return["","TK_EOF"];}aw=c.charAt(p);p+=1;}if(Y){if(k>1){for(ar=0;
ar<k;ar+=1){D(ar===0);ak=true;}}}W=k>0;}if(M(aw,ab)){if(p<w){while(M(c.charAt(p),ab)){aw+=c.charAt(p);p+=1;if(p===w){break;}}}if(p!==w&&aw.match(/^[0-9]+[Ee]$/)&&(c.charAt(p)==="-"||c.charAt(p)==="+")){var ao=c.charAt(p);
p+=1;var az=aa(p);aw+=ao+az[0];return[aw,"TK_WORD"];}if(aw==="in"){return[aw,"TK_OPERATOR"];}if(W&&U!=="TK_OPERATOR"&&U!=="TK_EQUALS"&&!v.if_line&&(Y||n!=="var")){D();}return[aw,"TK_WORD"];}if(aw==="("||aw==="["){return[aw,"TK_START_EXPR"];
}if(aw===")"||aw==="]"){return[aw,"TK_END_EXPR"];}if(aw==="{"){return[aw,"TK_START_BLOCK"];}if(aw==="}"){return[aw,"TK_END_BLOCK"];}if(aw===";"){return[aw,"TK_SEMICOLON"];}if(aw==="/"){var at="";var ax=true;
if(c.charAt(p)==="*"){p+=1;if(p<w){while(p<w&&!(c.charAt(p)==="*"&&c.charAt(p+1)&&c.charAt(p+1)==="/")){aw=c.charAt(p);at+=aw;if(aw==="\n"||aw==="\r"){ax=false;}p+=1;if(p>=w){break;}}}p+=2;if(ax&&k==0){return["/*"+at+"*/","TK_INLINE_COMMENT"];
}else{return["/*"+at+"*/","TK_BLOCK_COMMENT"];}}if(c.charAt(p)==="/"){at=aw;while(c.charAt(p)!=="\r"&&c.charAt(p)!=="\n"){at+=c.charAt(p);p+=1;if(p>=w){break;}}if(W){D();}return[at,"TK_COMMENT"];}}if(aw==="'"||aw==='"'||(aw==="/"&&((U==="TK_WORD"&&O(n))||(n===")"&&M(v.previous_mode,["(COND-EXPRESSION)","(FOR-EXPRESSION)"]))||(U==="TK_COMMENT"||U==="TK_START_EXPR"||U==="TK_START_BLOCK"||U==="TK_END_BLOCK"||U==="TK_OPERATOR"||U==="TK_EQUALS"||U==="TK_EOF"||U==="TK_SEMICOLON")))){var aA=aw;
var av=false;var am=0;var al=0;var an=aw;if(p<w){if(aA==="/"){var au=false;while(av||au||c.charAt(p)!==aA){an+=c.charAt(p);if(!av){av=c.charAt(p)==="\\";if(c.charAt(p)==="["){au=true;}else{if(c.charAt(p)==="]"){au=false;
}}}else{av=false;}p+=1;if(p>=w){return[an,"TK_STRING"];}}}else{while(av||c.charAt(p)!==aA){an+=c.charAt(p);if(am&&am>=al){am=parseInt(an.substr(-al),16);if(am&&am>=32&&am<=126){am=String.fromCharCode(am);
an=an.substr(0,an.length-al-2)+(((am===aA)||(am==="\\"))?"\\":"")+am;}am=0;}if(am){am++;}else{if(!av){av=c.charAt(p)==="\\";}else{av=false;if(ac){if(c.charAt(p)==="x"){am++;al=2;}else{if(c.charAt(p)==="u"){am++;
al=4;}}}}}p+=1;if(p>=w){return[an,"TK_STRING"];}}}}p+=1;an+=aA;if(aA==="/"){while(p<w&&M(c.charAt(p),ab)){an+=c.charAt(p);p+=1;}}return[an,"TK_STRING"];}if(aw==="#"){if(E.length===0&&c.charAt(p)==="!"){an=aw;
while(p<w&&aw!="\n"){aw=c.charAt(p);an+=aw;p+=1;}E.push(a(an)+"\n");D();return aa();}var aq="#";if(p<w&&M(c.charAt(p),af)){do{aw=c.charAt(p);aq+=aw;p+=1;}while(p<w&&aw!=="#"&&aw!=="=");if(aw==="#"){}else{if(c.charAt(p)==="["&&c.charAt(p+1)==="]"){aq+="[]";
p+=2;}else{if(c.charAt(p)==="{"&&c.charAt(p+1)==="}"){aq+="{}";p+=2;}}}return[aq,"TK_WORD"];}}if(aw==="<"&&c.substring(p-1,p+3)==="<!--"){p+=3;aw="<!--";while(c.charAt(p)!="\n"&&p<w){aw+=c.charAt(p);p++;
}v.in_html_comment=true;return[aw,"TK_COMMENT"];}if(aw==="-"&&v.in_html_comment&&c.substring(p-1,p+2)==="-->"){v.in_html_comment=false;p+=2;if(W){D();}return["-->","TK_COMMENT"];}if(M(aw,g)){while(p<w&&M(aw+c.charAt(p),g)){aw+=c.charAt(p);
p+=1;if(p>=w){break;}}if(aw===","){return[aw,"TK_COMMA"];}else{if(aw==="="){return[aw,"TK_EQUALS"];}else{return[aw,"TK_OPERATOR"];}}}return[aw,"TK_UNKNOWN"];}ag="";while(L>0){ag+=j;L-=1;}while(d&&(d.charAt(0)===" "||d.charAt(0)==="\t")){aj+=d.charAt(0);
d=d.substring(1);}c=d;C="";U="TK_START_EXPR";n="";y="";E=[];G=false;H="\n\r\t ".split("");ab="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");af="0123456789".split("");g="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::";
g+=" <%= <% %> <?= <? ?>";g=g.split(" ");x="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(",");e=[];o("BLOCK");p=0;while(true){var X=aa(p);r=X[0];Z=X[1];if(Z==="TK_EOF"){break;
}switch(Z){case"TK_START_EXPR":if(r==="["){if(U==="TK_WORD"||n===")"){if(M(n,x)){A();}o("(EXPRESSION)");K();break;}if(v.mode==="[EXPRESSION]"||v.mode==="[INDENTED-EXPRESSION]"){if(y==="]"&&n===","){if(v.mode==="[EXPRESSION]"){v.mode="[INDENTED-EXPRESSION]";
if(!m){q();}}o("[EXPRESSION]");if(!m){D();}}else{if(n==="["){if(v.mode==="[EXPRESSION]"){v.mode="[INDENTED-EXPRESSION]";if(!m){q();}}o("[EXPRESSION]");if(!m){D();}}else{o("[EXPRESSION]");}}}else{o("[EXPRESSION]");
}}else{if(C==="for"){o("(FOR-EXPRESSION)");}else{if(M(C,["if","while"])){o("(COND-EXPRESSION)");}else{o("(EXPRESSION)");}}}if(n===";"||U==="TK_START_BLOCK"){D();}else{if(U==="TK_END_EXPR"||U==="TK_START_EXPR"||U==="TK_END_BLOCK"||n==="."){if(W){D();
}}else{if(U!=="TK_WORD"&&U!=="TK_OPERATOR"){A();}else{if(C==="function"||C==="typeof"){if(u){A();}}else{if(M(n,x)||n==="catch"){if(I){A();}}}}}}K();break;case"TK_END_EXPR":if(r==="]"){if(m){if(n==="}"){R();
K();f();break;}}else{if(v.mode==="[INDENTED-EXPRESSION]"){if(n==="]"){f();D();K();break;}}}}f();K();break;case"TK_START_BLOCK":if(C==="do"){o("DO_BLOCK");}else{o("BLOCK");}if(T=="expand"||T=="expand-strict"){var ah=false;
if(T=="expand-strict"){ah=(V()=="}");if(!ah){D(true);}}else{if(U!=="TK_OPERATOR"){if(n==="="||(O(n)&&n!=="else")){A();}else{D(true);}}}K();if(!ah){q();}}else{if(U!=="TK_OPERATOR"&&U!=="TK_START_EXPR"){if(U==="TK_START_BLOCK"){D();
}else{A();}}else{if(P(v.previous_mode)&&n===","){if(y==="}"){A();}else{D();}}}q();K();}break;case"TK_END_BLOCK":f();if(T=="expand"||T=="expand-strict"){if(n!=="{"){D();}K();}else{if(U==="TK_START_BLOCK"){if(ak){R();
}else{s();}}else{if(P(v.mode)&&m){m=false;D();m=true;}else{D();}}K();}break;case"TK_WORD":if(G){A();K();A();G=false;break;}if(r==="function"){if(v.var_line){v.var_line_reindented=true;}if((ak||n===";")&&n!=="{"&&U!="TK_BLOCK_COMMENT"&&U!="TK_COMMENT"){k=ak?k:0;
if(!Y){k=1;}for(var ad=0;ad<2-k;ad++){D(false);}}if(U=="TK_WORD"||n==="get"||n==="set"||n==="new"){A();}K();C=r;break;}if(r==="case"||(r==="default"&&v.in_case_statement)){if(n===":"||v.case_body){R();
}else{if(!l){v.indentation_level--;}D();if(!l){v.indentation_level++;}}K();v.in_case=true;v.in_case_statement=true;v.case_body=false;break;}S="NONE";if(U==="TK_END_BLOCK"){if(!M(r.toLowerCase(),["else","catch","finally"])){S="NEWLINE";
}else{if(T=="expand"||T=="end-expand"||T=="expand-strict"){S="NEWLINE";}else{S="SPACE";A();}}}else{if(U==="TK_SEMICOLON"&&(v.mode==="BLOCK"||v.mode==="DO_BLOCK")){S="NEWLINE";}else{if(U==="TK_SEMICOLON"&&F(v.mode)){S="SPACE";
}else{if(U==="TK_STRING"){S="NEWLINE";}else{if(U==="TK_WORD"){if(n==="else"){s(true);}S="SPACE";}else{if(U==="TK_START_BLOCK"){S="NEWLINE";}else{if(U==="TK_END_EXPR"){A();S="NEWLINE";}}}}}}}if(M(r,x)&&n!==")"){if(n=="else"){S="SPACE";
}else{S="NEWLINE";}}if(v.if_line&&U==="TK_END_EXPR"){v.if_line=false;}if(M(r.toLowerCase(),["else","catch","finally"])){if(U!=="TK_END_BLOCK"||T=="expand"||T=="end-expand"||T=="expand-strict"){D();}else{s(true);
A();}}else{if(S==="NEWLINE"){if(O(n)){A();}else{if(U!=="TK_END_EXPR"){if((U!=="TK_START_EXPR"||r!=="var")&&n!==":"){if(r==="if"&&C==="else"&&n!=="{"){A();}else{v.var_line=false;v.var_line_reindented=false;
D();}}}else{if(M(r,x)&&n!=")"){v.var_line=false;v.var_line_reindented=false;D();}}}}else{if(P(v.mode)&&n===","&&y==="}"){D();}else{if(S==="SPACE"){A();}}}}K();C=r;if(r==="var"){v.var_line=true;v.var_line_reindented=false;
v.var_line_tainted=false;}if(r==="if"){v.if_line=true;}if(r==="else"){v.if_line=false;}break;case"TK_SEMICOLON":K();v.var_line=false;v.var_line_reindented=false;if(v.mode=="OBJECT"){v.mode="BLOCK";}break;
case"TK_STRING":if(U==="TK_END_EXPR"&&M(v.previous_mode,["(COND-EXPRESSION)","(FOR-EXPRESSION)"])){A();}else{if(U==="TK_COMMENT"||U=="TK_STRING"||U==="TK_START_BLOCK"||U==="TK_END_BLOCK"||U==="TK_SEMICOLON"){D();
}else{if(U==="TK_WORD"){A();}}}K();break;case"TK_EQUALS":if(v.var_line){v.var_line_tainted=true;}A();K();A();break;case"TK_COMMA":if(v.var_line){if(F(v.mode)){v.var_line_tainted=false;}if(v.var_line_tainted){K();
v.var_line_reindented=true;v.var_line_tainted=false;D();break;}else{v.var_line_tainted=false;}K();A();break;}if(U=="TK_COMMENT"){D();}if(U==="TK_END_BLOCK"&&v.mode!=="(EXPRESSION)"){K();if(v.mode==="OBJECT"&&n==="}"){D();
}else{A();}}else{if(v.mode==="OBJECT"){K();D();}else{K();A();}}break;case"TK_OPERATOR":var b=true;var J=true;if(O(n)){A();K();break;}if(r=="*"&&U=="TK_UNKNOWN"&&!y.match(/^\d+$/)){K();break;}if(r===":"&&v.in_case){if(l){v.case_body=true;
}K();D();v.in_case=false;break;}if(r==="::"){K();break;}if(M(r,["--","++","!"])||(M(r,["-","+"])&&(M(U,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||M(n,x)))){b=false;J=false;if(n===";"&&F(v.mode)){b=true;
}if(U==="TK_WORD"&&M(n,x)){b=true;}if(v.mode==="BLOCK"&&(n==="{"||n===";")){D();}}else{if(r==="."){b=false;}else{if(r===":"){if(v.ternary_depth==0){if(v.mode=="BLOCK"){v.mode="OBJECT";}b=false;}else{v.ternary_depth-=1;
}}else{if(r==="?"){v.ternary_depth+=1;}}}}if(b){A();}K();if(J){A();}break;case"TK_BLOCK_COMMENT":var N=ae(r);if(ai(N.slice(1),"*")){D();E.push(N[0]);for(ad=1;ad<N.length;ad++){D();E.push(" ");E.push(a(N[ad]));
}}else{if(N.length>1){D();}else{if(U==="TK_END_BLOCK"){D();}else{A();}}for(ad=0;ad<N.length;ad++){E.push(N[ad]);E.push("\n");}}if(V("\n")!="\n"){D();}break;case"TK_INLINE_COMMENT":A();K();if(F(v.mode)){A();
}else{h();}break;case"TK_COMMENT":if(n==","&&!W){s(true);}if(U!="TK_COMMENT"){if(W){D();}else{A();}}K();break;case"TK_UNKNOWN":if(O(n)){A();}K();break;}y=n;U=Z;n=r;}var Q=aj+E.join("").replace(/[\r\n ]+$/,"");
return Q;}if(typeof exports!=="undefined"){exports.js_beautify=js_beautify;}